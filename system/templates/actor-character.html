<form class="gambiarra-sheet" autocomplete="off">
  <header class="sheet-header">
    <h1>{{actor.name}}</h1>
    <p class="arquetipo">{{system.meta.arquetipo}}</p>
  </header>

  {{!-- BUG --}} {{#if system.meta.bug.ativo}}
  <section class="bug-state {{system.meta.bug.intensidade}}">
    ğŸ <strong>BUG {{system.meta.bug.intensidade}}</strong><br />
    {{system.meta.bug.descricao}} {{#if @root.isGM}}
    <button type="button" class="clear-bug">Resolver BUG</button>
    {{/if}}
  </section>
  {{/if}} 
  
  {{!-- ATRIBUTOS (EDITÃVEIS) --}}
  <section class="attributes">
    <div class="attribute corpo">
      <h2>ğŸŸ¢ Corpo</h2>
      <input
        type="number"
        name="system.attributes.corpo.value"
        value="{{system.attributes.corpo.value}}"
        min="1"
        max="4"
        step="1"
      />
    </div>

    <div class="attribute mente">
      <h2>ğŸ”µ Mente</h2>
      <input
        type="number"
        name="system.attributes.mente.value"
        value="{{system.attributes.mente.value}}"
        min="1"
        max="4"
        step="1"
      />
    </div>

    <div class="attribute coracao">
      <h2>ğŸ”´ CoraÃ§Ã£o</h2>
      <input
        type="number"
        name="system.attributes.coracao.value"
        value="{{system.attributes.coracao.value}}"
        min="1"
        max="4"
        step="1"
      />
    </div>

    <div class="gambiarra-sumbar ok">
      <div class="sum-left">
        <span>ğŸ“ Soma</span>
        <span class="sum-pill">6</span>
      </div>
      <div class="sum-right">Regra opcional ativa</div>
    </div>
  </section>

  <section class="roll-section">
    <button type="button" class="roll-desafio">ğŸ² Rolar Desafio</button>
  </section>

  {{!-- PODERES --}}
  <section class="powers">
    <h2>âš¡ Poderes Gambiarra</h2>

    {{#if (eq poderes.length 0)}}
    <p class="hint">
      Nenhum poder ainda.<br />Eles surgem em momentos de tensÃ£o.
    </p>
    {{/if}}

    <ul class="power-list">
      {{#each poderes as |poder|}}
      <li class="power power-{{poder.system.estado}}">
        <header>
          <strong>{{poder.name}}</strong>
          <span class="state">{{poder.system.estado}}</span>
        </header>

        <p class="description">{{poder.system.descricao}}</p>

        {{#if poder.system.efeitosPossiveis.length}}
        <ul class="power-effects">
          {{#each poder.system.efeitosPossiveis}}
          <li>
            {{#if (eq this "dado-roxo")}}ğŸŸ£ Dado Roxo{{/if}} {{#if (eq this
            "reduzir-dificuldade")}}ğŸ¯ Reduz dificuldade{{/if}} {{#if (eq this
            "rerrolar")}}ğŸ” Re-rolar 1 dado{{/if}}
          </li>
          {{/each}}
        </ul>
        {{/if}}

        <div class="power-status">
          {{#if (eq poder.system.estado "ativo")}} âš¡ Ativo â€” pode forÃ§ar o NÃ³
          {{/if}} {{#if (eq poder.system.estado "esgotado")}} âš  Esgotado â€” risco
          elevado {{/if}} {{#if (eq poder.system.estado "fora")}} ğŸ Fora de
          controle â€” BUG iminente {{/if}}
        </div>

        {{#if @root.isGM}}
        <div class="power-controls">
          <button
            type="button"
            class="power-state"
            data-item-id="{{poder.id}}"
            data-set="ativo"
          >
            Ativar
          </button>
          <button
            type="button"
            class="power-state"
            data-item-id="{{poder.id}}"
            data-set="esgotado"
          >
            Esgotar
          </button>
          <button
            type="button"
            class="power-state"
            data-item-id="{{poder.id}}"
            data-set="fora"
          >
            Fora
          </button>
        </div>
        {{/if}}
      </li>
      {{/each}}
    </ul>

    {{#if @root.isGM}}
    <button type="button" class="add-power">â• Despertar Poder</button>
    <button type="button" class="roll-power">ğŸ² Sortear Poder</button>
    {{/if}}
  </section>

  {{!-- EFEITOS --}}
  <section class="effects">
    <h2>ğŸ§  Efeitos do NÃ³</h2>

    {{#if (or system.meta.marcas.length system.meta.custos.length
    system.meta.corrupcoes.length)}} {{#if system.meta.marcas.length}}
    <h3>ğŸ§¬ Marcas do NÃ³</h3>
    <ul>
      {{#each system.meta.marcas}}
      <li><strong>{{this.nome}}</strong> â€” {{this.descricao}}</li>
      {{/each}}
    </ul>
    {{/if}} {{#if system.meta.custos.length}}
    <h3>ğŸ’” Custos Emocionais</h3>
    <ul>
      {{#each system.meta.custos}}
      <li><strong>{{this.nome}}</strong> â€” {{this.descricao}}</li>
      {{/each}}
    </ul>
    {{/if}} {{#if system.meta.corrupcoes.length}}
    <h3>ğŸ§© CorrupÃ§Ãµes</h3>
    <ul>
      {{#each system.meta.corrupcoes}}
      <li><strong>{{this.nome}}</strong> â€” {{this.descricao}}</li>
      {{/each}}
    </ul>
    {{/if}} {{else}}
    <p class="hint">Nenhum efeito permanenteâ€¦ ainda.</p>
    {{/if}} {{#if @root.isGM}}
    <button type="button" class="add-effect">
      â• Registrar Efeito Permanente
    </button>
    <button type="button" class="bug-effect">ğŸ BUG â†’ Efeito Permanente</button>
    {{/if}}
  </section>

  {{!-- ITENS --}}
  <section class="items">
    <h2>ğŸ’ Itens do NÃ³</h2>
    <ul>
      {{#each items as |item|}}
      <li>
        {{item.name}} {{#if (and ../system.meta.bug.ativo
        item.system.reageABug)}} {{#if @root.isGM}}
        <button type="button" class="use-item-bug" data-item-id="{{item.id}}">
          ğŸ Usar no BUG
        </button>
        {{/if}} {{/if}}
      </li>
      {{/each}}
    </ul>
  </section>
</form>
